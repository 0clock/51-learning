C51 COMPILER V9.60.0.0   ADC                                                               04/21/2023 13:03:50 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE ADC
OBJECT MODULE PLACED IN .\OBJ\ADC.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE Library\src\ADC.c LARGE OMF2 WARNINGLEVEL(1) OPTIMIZE(8,SPEED) INCDIR(.\
                    -Library\inc;.\USER) PRINT(.\ADC.lst) TABS(2) OBJECT(.\OBJ\ADC.obj)

line level    source

   1          /*********************************************************************************************************
   2          ** ļ STC12C5A60S2AD
   3          **  Blue Sky TeamsZZL
   4          ** ̰汾 V1.0
   5          *********************************************************************************************************/
   6          #include "ADC.h"
   7          
   8          /*********************************************************************************************************
   9          **  ADCĳʼ
  10          ** ˵ ʹADCʱҪöӦP1ڵĹܽΪģ
  11          ** ڲ portҪΪģͨʹûͬʱöܽ
  12          **        磺ADC_Init(ADC_PORT0 | ADC_PORT1 | ADC_PORT2)ô˺ͬʱP1^0,P1^1,P1^2Ϊģ
  13          ** ڲ 
  14          *********************************************************************************************************/
  15          void ADC_Init(unsigned char port)
  16          {
  17   1        P1ASF=port;//ADתͨ
  18   1        ADC_RES=0;//ת
  19   1        ADC_CONTR=ADC_POWER | ADC_SPEEDLL_540;//ADתԴ
  20   1        
  21   1      
  22   1      
  23   1      //  IE=0XA0;//жϣADCж
  24   1        _nop_();
  25   1        _nop_();
  26   1        _nop_();
  27   1        _nop_();
  28   1      }
  29          /*********************************************************************************************************
  30          **  ȡADCӦͨĵѹֵ
  31          ** ˵ ÿֻܻȡһͨĵѹֵͬͨҪֱøúȡ
  32          ** ڲ channelȡͨĵѹֵ
  33          ** ڲ result ǰͨĵѹֵ
  34          *********************************************************************************************************/
  35          float GetADCResult(unsigned char channel)//ȡͨchĵѹֵ
  36          {
  37   1        unsigned int ADC_RESULT = 0;//Ž
  38   1        float result;
  39   1        ADC_CONTR = ADC_POWER | ADC_SPEEDLL_540 | ADC_START | channel;//ʼתòͨΪP1^0
  40   1        _nop_();//辭ĸCPUʱʱֵܱ֤ADC_CONTRƼĴ
  41   1        _nop_();
  42   1        _nop_();
  43   1        _nop_();
  44   1        while(!(ADC_CONTR & ADC_FLAG));//ȴת
  45   1        ADC_CONTR &= ~ADC_FLAG;//жϿλ
  46   1        ADC_RESULT = ADC_RES;
  47   1        ADC_RESULT = (ADC_RESULT << 2) | (0x02 & ADC_RESL); //Ĭݴ洢ʽ߰λADC_RES,ͶλADC_RESL
             -Ͷλ
  48   1        result = ADC_RESULT * 5.0 / 1024.0 ;  //׼ѹΪԴѹ5V10ķֱʣ1024
  49   1        return result;
  50   1      }
  51          
  52          

C51 COMPILER V9.60.0.0   ADC                                                               04/21/2023 13:03:50 PAGE 2   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     87    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
